var d;Ingemi=function(a,b){if(!a||"DIV"!=a.nodeName)throw Error("You must specify Ingemi's container");b=b||{};this.i=a;this.x=b.x||0;this.y=b.y||0;this.a=b.z||1;this.u=b.maxIteration||255;this.e=b.sample||1;this.m=b.workers||1;this.v=b.minStdDev||10;this.j=3.5;this.k=2;this.h=this.n=0;this.f=[];for(var c=0;c<this.m;c++)this.f.push(new Worker("w.mandelbrot.js"));this.b=this.d=this.canvas=null;this.g=this.height=this.width=this.o=this.clientHeight=this.clientWidth=0;this.c=!1};d=Ingemi.prototype;
d.s=function(){console.time("total");var a=this;a.t();a.w();for(var b=0;b<a.m;b++)a.f[b].onmessage=function(b){a.x=b.data.x||a.x;a.y=b.data.y||a.y;a.a=b.data.z||a.a;b=new Uint8ClampedArray(b.data.imagedata,0,4*a.g);a.b=a.d.createImageData(a.width,a.height);a.b.data.set(b);a.r()}};d.t=function(){this.canvas=document.createElement("canvas");this.i.appendChild(this.canvas);this.d=this.canvas.getContext("2d")};
d.w=function(){this.clientWidth=this.i.clientWidth;this.clientHeight=this.i.clientHeight;this.width=Math.floor(this.clientWidth/this.e);this.height=Math.floor(this.clientHeight/this.e);this.canvas.style.width=this.clientWidth+"px";this.canvas.style.height=this.clientHeight+"px";this.o=Math.round(this.clientWidth*this.k/this.j)/this.clientHeight;this.g=this.width*this.height;this.n=this.g/this.m;this.b=this.d.createImageData(this.width,this.height)};
d.l=function(){this.c||(this.c=!0,console.time("render"),this.h=0,this.f[0].postMessage(this.p("render"),[this.b.data.buffer]))};d.p=function(a){var b={};b.type=a;var a=b.state={},c=b.settings={};a.x=this.x;a.y=this.y;a.z=this.a;a.blockOffset=this.h;c.dx=this.j;c.dy=this.k;c.forcedHeight=this.o;c.blockSize=this.n;c.totalPixels=this.g;c.width=this.width;c.height=this.height;c.maxIteration=this.u;c.minStdDev=this.v;b.buffer=this.b.data.buffer;return b};
d.r=function(){this.canvas.width=this.width;this.canvas.height=this.height;this.d.putImageData(this.b,0,0);this.c=!1;console.timeEnd("render");console.timeEnd("total")};d.zoom=function(a){this.a*=a;this.l()};d.q=function(a,b){this.x+=(a/this.e/this.width-0.5)*this.j*this.a;this.y+=(b/this.e/this.height-0.5)*this.k*this.a;this.l()};d.reset=function(){this.y=this.x=0;this.a=1};d.random=function(){this.c||(this.c=!0,console.time("render"),this.h=0,this.f[0].postMessage(this.p("random"),[this.b.data.buffer]))};
window.Ingemi=Ingemi;Ingemi.prototype.init=Ingemi.prototype.s;Ingemi.prototype.render=Ingemi.prototype.l;Ingemi.prototype.zoom=Ingemi.prototype.zoom;Ingemi.prototype.center=Ingemi.prototype.q;Ingemi.prototype.reset=Ingemi.prototype.reset;Ingemi.prototype.random=Ingemi.prototype.random;
