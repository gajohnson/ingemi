var e;Ingemi=function(c,a){if(!c||"DIV"!=c.nodeName)throw Error("You must specify the div where Ingemi will render");a=a||{};this.l=c;this.d=a.upscale||1;this.offsetLeft=a.offsetLeft||0;this.offsetTop=a.offsetTop||0;this.j=3.5;this.k=2;this.scale=1;this.I=a.minStdDev||10;this.i=a.maxIteration||255;this.e=a.blockSize||2E3;this.u="function"===typeof a.onrender?a.onrender:null;this.C=Math.round(2*c.clientWidth/3.5)/c.clientHeight;this.p=this.c=!1;this.g=[]};e=Ingemi.prototype;
e.F=function(){this.H();this.w()};
e.H=function(){this.canvas=document.createElement("canvas");this.l.appendChild(this.canvas);this.A=this.canvas.getContext("2d");this.clientWidth=this.l.clientWidth;this.clientHeight=this.l.clientHeight;this.canvas.style.width=this.clientWidth+"px";this.canvas.style.height=this.clientHeight+"px";this.o=document.createElement("canvas");this.K=this.o.getContext("2d");this.status=document.getElementById("status");this.N=document.getElementById("x");this.O=document.getElementById("y");this.P=document.getElementById("z")};
e.w=function(){this.width=Math.floor(this.clientWidth/this.d);this.height=Math.floor(this.clientHeight/this.d);this.o.width=this.width;this.o.height=this.height;this.b=this.K.createImageData(this.width,this.height);this.h=this.width*this.height};e.m=function(){this.c||(this.c=!0,console.time("render"),this.status.innerText=0,this.N.innerText=this.offsetLeft,this.O.innerText=this.offsetTop,this.P.innerText=Math.log(1/this.scale)/Math.LN2,this.a=this.f=this.n=0,this.v())};
e.v=function(){var c=this.e+this.a>this.h?this.h-this.a:this.e;this.g=[];for(var a=0;a<c;a+=1){var b=this.a+a;this.L(b%this.width,Math.floor(b/this.width))}};e.L=function(c,a){var b=this;this.g.push(setTimeout(function(){b.M(4*b.D(c,a),b.t(c,a));b.Q()},0))};e.D=function(c,a){return a*this.width+c};
e.t=function(c,a){var b,f;b=this.scale*(this.j*c/this.width-1.75)+this.offsetLeft;f=this.scale/this.C*(this.k*a/this.height-1)+this.offsetTop;if(this.G(b,f))return this.i;for(var d=0,g=0,h=0,i;4>d*d+g*g&&h<this.i;)i=d*d-g*g+b,g=2*d*g+f,d=i,h+=1;return h};e.G=function(c,a){var b=Math.pow(c-0.25,2)+a*a;return c<=Math.sqrt(b)-2*b+0.25};
e.M=function(c,a){var b,f,d,a=6*a/this.i;1>a?(b=255,f=255*a,d=0):2>a?(b=255*(2-a),f=255,d=0):3>a?(b=0,f=255,d=255*(a-2)):4>a?(b=0,f=255*(4-a),d=255):5>a?(b=255*(a-4),f=0,d=255):(b=255,f=0,d=255*(6-a));this.b.data[c]=b;this.b.data[c+1]=f;this.b.data[c+2]=d;this.b.data[c+3]=255};e.Q=function(){this.n+=1;this.f+=1;this.n==this.h?(this.B(),this.s()):this.f===this.e&&this.J()};e.J=function(){this.a+=this.e;this.status.innerText=Math.round(100*this.a/this.h);this.f=0;this.v()};
e.B=function(){this.canvas.width=this.width;this.canvas.height=this.height;this.A.putImageData(this.b,0,0)};e.s=function(){this.status.innerText=100;console.timeEnd("render");this.p?(this.p=!1,this.r(1),this.c=!1,this.m()):this.c=!1;this.u&&this.u()};e.zoom=function(c){this.scale=c;this.q()};e.z=function(c,a){this.offsetLeft+=(c/this.d/this.width-0.5)*this.j*this.scale;this.offsetTop+=(a/this.d/this.height-0.5)*this.k*this.scale;this.q()};
e.reset=function(){this.offsetTop=this.offsetLeft=0;this.scale=1};e.r=function(c){this.d=c;this.w()};e.cancel=function(){for(;this.g.length;)clearTimeout(this.g.pop());this.s()};e.q=function(){this.c&&this.cancel();this.p=!0;this.r(8);this.m()};
e.random=function(){function c(a,b){for(var c=a.length,d=0,f=0;f<c;f++)var g=a[f]-b,d=d+g*g;return Math.pow(d/c,0.5)}function a(a){for(var b=0,c=a.length,d=0;d<c;d++)b+=a[d];return b/c}var b,f,d;do{b=[];this.scale=1/Math.pow(2,Math.floor(22*Math.random())+10);this.offsetLeft=this.j*(Math.random()-0.5);this.offsetTop=this.k*(Math.random()-0.5);for(var g=0;16>g;g++)f=Math.floor(g%4*this.width/4),d=Math.floor(Math.floor(g/4)*this.height/4),b.push(this.t(f,d))}while(c(b,a(b))<this.I);console.log(c(b,
a(b)));this.q()};e.save=function(){var c=this.canvas.width,a=this.canvas.height,b="left=0,top=0,width="+c+",height="+a+",toolbar=0,resizable=0",f=this.canvas.toDataURL("image/png"),b=window.open("","Ingemi",b);b.document.write("<title>Ingemi Export Image</title>");b.document.write("<img id='exportImage' alt='' height='"+a+"' width='"+c+"' style='position:absolute;left:0;top:0'/>");b.document.close();b.document.getElementById("exportImage").src=f};window.Ingemi=Ingemi;Ingemi.prototype.init=Ingemi.prototype.F;
Ingemi.prototype.render=Ingemi.prototype.m;Ingemi.prototype.zoom=Ingemi.prototype.zoom;Ingemi.prototype.center=Ingemi.prototype.z;Ingemi.prototype.reset=Ingemi.prototype.reset;Ingemi.prototype.random=Ingemi.prototype.random;Ingemi.prototype.save=Ingemi.prototype.save;Ingemi.prototype.upscale=Ingemi.prototype.r;
