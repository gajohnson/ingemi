var f;Ingemi=function(b,a){if(!b||"DIV"!=b.nodeName)throw Error("You must specify the div where Ingemi will render");a=a||{};this.k=b;this.s=a.upscale||1;this.offsetLeft=a.offsetLeft||0;this.offsetTop=a.offsetTop||0;this.e=3.5;this.f=2;this.scale=1;this.F=a.minStdDev||10;this.j=a.maxIteration||255;this.d=a.blockSize||2E3;this.p="function"===typeof a.onrender?a.onrender:null;this.A=Math.round(b.clientWidth*this.f/this.e)/b.clientHeight;this.i=!1};f=Ingemi.prototype;f.B=function(){this.D();this.r()};
f.D=function(){this.canvas=document.createElement("canvas");this.k.appendChild(this.canvas);this.v=this.canvas.getContext("2d");this.clientWidth=this.k.clientWidth;this.clientHeight=this.k.clientHeight;this.canvas.style.width=this.clientWidth+"px";this.canvas.style.height=this.clientHeight+"px";this.m=document.createElement("canvas");this.H=this.m.getContext("2d");this.status=document.getElementById("status");this.J=document.getElementById("x");this.K=document.getElementById("y");this.L=document.getElementById("z")};
f.r=function(){this.width=Math.floor(this.clientWidth/this.c());this.height=Math.floor(this.clientHeight/this.c());this.m.width=this.width;this.m.height=this.height;this.b=this.H.createImageData(this.width,this.height);this.n=this.width*this.height};f.g=function(){var b=this;setTimeout(function(){b.t()},0)};
f.t=function(){this.i||(this.i=!0,console.time("render"),this.status.innerText=0,this.J.innerText=this.offsetLeft,this.K.innerText=this.offsetTop,this.L.innerText=Math.log(1/this.scale)/Math.LN2,this.a=this.h=this.l=0,this.q())};f.q=function(){var b=this.d+this.a>this.n?this.n-this.a:this.d,a;for(a=0;a<b;a++){var c=this.a+a,e=c%this.width,d=Math.floor(c/this.width),c=4*(d*this.width+e);this.I(c,this.o(e,d));this.M()}};
f.o=function(b,a){var c,e;c=this.scale*(this.e*b/this.width-1.75)+this.offsetLeft;e=this.scale/this.A*(this.f*a/this.height-1)+this.offsetTop;if(this.C(c,e))return this.j;var d=0,g=0,h,i;for(h=0;4>d*d+g*g&&h<this.j;h++)i=d*d-g*g+c,g=2*d*g+e,d=i;return h};f.C=function(b,a){var c=(b-0.25)*(b-0.25)+a*a;return b<=Math.sqrt(c)-2*c+0.25};
f.I=function(b,a){var c,e,d,a=6*a/this.j;1>a?(c=255,e=255*a,d=0):2>a?(c=255*(2-a),e=255,d=0):3>a?(c=0,e=255,d=255*(a-2)):4>a?(c=0,e=255*(4-a),d=255):5>a?(c=255*(a-4),e=0,d=255):(c=255,e=0,d=255*(6-a));this.b.data[b]=c;this.b.data[b+1]=e;this.b.data[b+2]=d;this.b.data[b+3]=255};f.M=function(){this.l+=1;this.h+=1;this.l==this.n?(this.w(),this.z()):this.h===this.d&&this.G()};f.G=function(){this.a+=this.d;this.h=0;this.q()};
f.w=function(){this.canvas.width=this.width;this.canvas.height=this.height;this.v.putImageData(this.b,0,0)};f.z=function(){this.status.innerText=100;console.timeEnd("render");this.i=!1;this.p&&this.p()};f.zoom=function(b){this.scale=b;this.g()};f.u=function(b,a){this.offsetLeft+=(b/this.c()/this.width-0.5)*this.e*this.scale;this.offsetTop+=(a/this.c()/this.height-0.5)*this.f*this.scale;this.g()};f.reset=function(){this.offsetTop=this.offsetLeft=0;this.scale=1};
f.c=function(b){if(!b)return this.s;this.s=b;this.r()};
f.random=function(){function b(a,b){for(var c=a.length,d=0,e=0;e<c;e++)var g=a[e]-b,d=d+g*g;return Math.pow(d/c,0.5)}function a(a){for(var b=0,c=a.length,d=0;d<c;d++)b+=a[d];return b/c}var c,e,d,g=0;do{c=[];this.scale=1/Math.pow(2,Math.floor(22*Math.random())+10);this.offsetLeft=this.e*(Math.random()-0.5);this.offsetTop=this.f*(Math.random()-0.5);for(g=0;16>g;g++)e=Math.floor(g%4*this.width/4),d=Math.floor(Math.floor(g/4)*this.height/4),c.push(this.o(e,d));g++}while(b(c,a(c))<this.F&&100>g);this.g()};
f.save=function(){var b=this.canvas.width,a=this.canvas.height,c="left=0,top=0,width="+b+",height="+a+",toolbar=0,resizable=0",e=this.canvas.toDataURL("image/png"),c=window.open("","Ingemi",c);c.document.write("<title>Ingemi Export Image</title>");c.document.write("<img id='exportImage' alt='' height='"+a+"' width='"+b+"' style='position:absolute;left:0;top:0'/>");c.document.close();c.document.getElementById("exportImage").src=e};window.Ingemi=Ingemi;Ingemi.prototype.init=Ingemi.prototype.B;
Ingemi.prototype.render=Ingemi.prototype.g;Ingemi.prototype.zoom=Ingemi.prototype.zoom;Ingemi.prototype.center=Ingemi.prototype.u;Ingemi.prototype.reset=Ingemi.prototype.reset;Ingemi.prototype.random=Ingemi.prototype.random;Ingemi.prototype.save=Ingemi.prototype.save;Ingemi.prototype.upscale=Ingemi.prototype.c;
