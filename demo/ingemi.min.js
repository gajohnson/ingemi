var c;Ingemi=function(a){a=a||{};this.t();this.B();this.D(a);this.C();new IngemiZoom(this);this.m()};c=Ingemi.prototype;c.t=function(){this.e=document.getElementById("ingemi");if(!this.e)throw Error("You must include \"<div id='ingemi'></div>\" in your markup");};
c.B=function(){this.canvas=document.createElement("canvas");this.e.appendChild(this.canvas);this.c=this.canvas.getContext("2d");this.clientWidth=this.e.clientWidth;this.clientHeight=this.e.clientHeight;this.canvas.style.width=this.clientWidth+"px";this.canvas.style.height=this.clientHeight+"px"};
c.D=function(a){this.k=a.upscale||1;this.f=a.rangeLeft||1;this.g=a.rangeTop||1;this.offsetLeft=a.offsetLeft||0;this.offsetTop=a.offsetTop||0;this.i=a.maxIteration||255;this.h=a.blockSize||2500;this.p="function"===typeof a.onrender?a.onrender:null;this.l=!1};c.C=function(){this.width=this.canvas.width=Math.floor(this.clientWidth/this.k);this.height=this.canvas.height=Math.floor(this.clientHeight/this.k);this.d=this.c.createImageData(this.width,this.height);this.o=this.width*this.height};
c.m=function(){this.l?console.log("Ignoring request during rendering."):(this.l=!0,this.H=(new Date).getTime(),this.b=this.j=this.n=0,this.q())};c.q=function(){var a,b=this.h+this.b>this.o?this.o-this.b:this.h;for(a=0;a<b;a+=1){var d=this.b+a;this.F(d%this.width,Math.floor(d/this.width))}};c.F=function(a,b){var d=this;setTimeout(function(){d.G(4*d.v(a,b),d.u(a,b));d.I()},0)};c.v=function(a,b){return b*this.width+a};
c.u=function(a,b){var d=3.5*this.f*a/this.width-2.5+this.offsetLeft,h=2*this.g*b/this.height-1+this.offsetTop;if(this.z(d,h))return this.i;for(var e=0,f=0,g=0,i;4>e*e+f*f&&g<this.i;)i=e*e-f*f+d,f=2*e*f+h,e=i,g+=1;return g};c.z=function(a,b){var d=Math.pow(a-0.25,2)+b*b;return a<=Math.sqrt(d)-2*d+0.25};c.G=function(a,b){255<this.i&&(b=Math.floor(255*(b/this.i)));this.d.data[a]=b;this.d.data[a+1]=b;this.d.data[a+2]=b;this.d.data[a+3]=255};
c.I=function(){this.n+=1;this.j+=1;this.n==this.o?(this.c.putImageData(this.d,0,0),this.s(),this.l=!1,this.p&&this.p()):this.j===this.h&&(this.b+=this.h,this.j=0,this.q())};c.s=function(){this.c.fillStyle="rgba(255, 255, 255, 1)";this.c.fillRect(0,30,this.width,2);this.c.fillRect(30,0,2,this.height)};c.A=function(){console.log("Rendered "+this.width+" * "+this.height+" pixels in "+((new Date).getTime()-this.H)/1E3+" seconds.")};IngemiZoom=function(a){this.a=a;this.r()};
IngemiZoom.prototype.r=function(){var a=this;this.a.e.addEventListener("click",function(b){a.w(b.offsetX,b.offsetY)})};IngemiZoom.prototype.w=function(a,b){var a=a/this.a.k,b=b/this.a.k,d=b/this.a.height-0.5;this.a.offsetLeft+=3.5*(a/this.a.width-0.5)*this.a.f;this.a.offsetTop+=2*d*this.a.g;this.a.f/=2;this.a.g/=2;this.a.offsetLeft+=1.75*this.a.f;this.a.offsetTop+=this.a.g;this.a.m()};window.Ingemi=Ingemi;Ingemi.prototype.render=Ingemi.prototype.m;Ingemi.prototype.logStats=Ingemi.prototype.A;
